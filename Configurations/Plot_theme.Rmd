```{r}
devtools::install_github('bbc/bbplot')
library(scales)
```


### Plots colours

```{r}
# Colours:
colour1 = '#009999'
colour2 = '#1380A1'
colour3 = 'orange'
colour4 = '#333333'
colour5 = 'grey88'
colour6 = 'royalblue4'
colour7 = 'coral3'
colour8 = '#76b8a9'

```

### Single plots
```{r}
# Do the 'meat' of the plot first
repl2_barplot <- ggplot(repl_sample_2, aes(x=Protein, y = CV )) +
  geom_bar(stat = "identity", color="#1380A1") 

# Theme and fine tuning
repl2_barplot
  + geom_hline(yintercept = 25, linewidth = 0.5, colour="coral3", lty=2)  # this makes a dashed horizontal line
  + geom_hline(yintercept = 0, linewidth = 1, colour="#333333")   # this makes heavier bottom
  + bbc_style()
  + labs(title="Spread CV for sample 2",
          subtitle = "Variance across 3 technical replicates",
          y = "CV (%)",
          x = 'Proteins (1797 unique)') 
  + scale_y_continuous(breaks=c(0, 25, 50, 100, 200))   # this adds automatic ticks 
  + theme(
      plot.title = element_text(size = 15, face = 'bold', vjust = -8),
      plot.subtitle = element_text(size = 12, vjust = -8),
      axis.text.x = element_blank(),    # eliinates x-axis ticks 
      axis.title.x = element_text(size = 10),
      axis.title.y = element_text(size = 10),
      axis.text.y = element_text(size = 8))
```


### Panel with multiple plots

```{r}
top10_set2 <-  ggplot(set2_top10_genes, aes(x=reorder(Gene.Name, -Set2_Peptide.count), y=Set2_Peptide.count)) + 
  geom_bar(stat = "identity") +
  geom_text(aes(label = Set2_Peptide.count), vjust = -0.6) +
  xlab("Gene names") + 
  ylab('Peptide count') +
  ylim(0, 900) +
  ggtitle('Set 2')+
  theme(plot.title = element_text(size = 10, face = "bold", colour = "#009999"))
```



### Combine them all ###

```{r}
library(patchwork)
layout <- top10_set1 / top10_set2  / top10_set3 
layout &  theme(plot.tag = element_text(size = 14))
```

### Save
```{r}

ggsave(path = "C:/Users/1aria/Desktop/rep/Output/Plots", filename = "CV_sample2_and_9.png",plot,height=15,width=17,units="cm",dpi=200)

```


### Alternative combination
```{r}
# From lund qorkshop
title <- ggdraw() + 
  draw_label(
    "QQ plot of 9 randomly selected genes",
    fontface = 'bold',
    x = 0,
    hjust = 0) +  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot <- ggarrange(repl2_barplot, repl9_barplot, common.legend = TRUE)

annotate_figure(plot, top = text_grob("CV distribution for the two samples with replicates", 
               color = "#333333", face = "bold", size = 14))
```


```

